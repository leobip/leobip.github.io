<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Local Monitoring Stack for Kubernetes - My Personal Page</title>
<meta name="description" content="üì° Local Monitoring Stack for Kubernetes (Prometheus + Grafana + Kafka)">


  <meta name="author" content="Leoncio L√≥pez">
  
  <meta property="article:author" content="Leoncio L√≥pez">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="My Personal Page">
<meta property="og:title" content="Local Monitoring Stack for Kubernetes">
<meta property="og:url" content="http://localhost:4000/local-monitoring-env/">


  <meta property="og:description" content="üì° Local Monitoring Stack for Kubernetes (Prometheus + Grafana + Kafka)">







  <meta property="article:published_time" content="2025-07-26T18:32:04+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/local-monitoring-env/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="My Personal Page Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/alpha-omega-logo.jpg" alt="Leoncio L√≥pez"></a>
        
        <a class="site-title" href="/">
          Leoncio L√≥pez
          <span class="site-subtitle">Portfolio &amp; Proyects</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/year-archive/"
                
                
              >Posts</a>
            </li><li class="masthead__menu-item">
              <a
                href="/collection-archive/"
                
                
              >Collections</a>
            </li><li class="masthead__menu-item">
              <a
                href="/sitemap/"
                
                
              >Sitemap</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/llp-avatar.jpg" alt="Leoncio L√≥pez" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Leoncio L√≥pez</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Cloud &amp; DevOps Engineer ¬∑ Kubernetes ¬∑ Kafka ¬∑ Golang</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Madrid - Spain</span>
        </li>
      

      
        
          
            <li><a href="mailto:leobip27@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
            <li><a href="https://www.linkedin.com/in/leoncio-lopez-00527474/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
        
          
        
          
            <li><a href="https://github.com/leobip" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      
        <li>
          <a href="mailto:leobip27@gmail.com" rel="me" class="u-email">
            <meta itemprop="email" content="leobip27@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Local Monitoring Stack for Kubernetes">
    <meta itemprop="description" content="üì° Local Monitoring Stack for Kubernetes (Prometheus + Grafana + Kafka)">
    <meta itemprop="datePublished" content="2025-07-26T18:32:04+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="http://localhost:4000/local-monitoring-env/" itemprop="url">Local Monitoring Stack for Kubernetes
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h1 id="-local-monitoring-stack-for-kubernetes-prometheus--grafana--kafka">üì° Local Monitoring Stack for Kubernetes (Prometheus + Grafana + Kafka)</h1>

<p>https://github.com/leobip/monitoring.git</p>

<p>Welcome! üëã
This project sets up a local monitoring stack based on Prometheus, Grafana, and Kafka (with Kafka UI), using Helm charts and persistent volumes for durability.</p>

<p>Whether you‚Äôre experimenting with Kubernetes, developing custom controllers, or just want to see your cluster‚Äôs activity in real time ‚Äî this guide has got you covered.
By the end, you‚Äôll have a working environment where:</p>

<p>Prometheus collects metrics from your apps and infrastructure üß≤</p>

<p>Grafana helps you visualize those metrics with beautiful dashboards üìä</p>

<p>Kafka acts as a telemetry backbone, and Kafka-UI lets you explore the events flowing through it üîÑ</p>

<p>This setup runs entirely on your local machine, making it ideal for testing and development ‚Äî no cloud account or external services required!</p>

<hr />

<h2 id="-what-youll-get">üöÄ What You‚Äôll Get</h2>

<p>Once deployed, your local monitoring stack will include:</p>

<p>‚úÖ A Prometheus instance, scraping metrics on port 30090</p>

<p>‚úÖ A Grafana dashboard, accessible at localhost:30095</p>

<p>‚úÖ A Kafka broker with persistent volumes</p>

<p>‚úÖ Kafka UI at localhost:30096 to inspect topics and messages</p>

<p>‚úÖ A health check script to ensure everything is up and running</p>

<hr />

<h2 id="-prometheus--grafana">üì¶ Prometheus + Grafana</h2>

<p>We‚Äôll use the official Helm charts from Bitnami and Prometheus Community, with a few tweaks for local development and persistence. See values files for config details.</p>

<h2 id="-kafka--kafka-ui">üß± Kafka + Kafka UI</h2>

<p>This section helps you install Kafka in plaintext mode, along with a lightweight UI to browse topics and messages.</p>

<p>Persistent volumes are enabled so your topics and messages stick around across Minikube restarts.</p>

<hr />

<h2 id="-folder-structure">üß± Folder Structure</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>monitoring/
‚îú‚îÄ‚îÄ deploy-all.sh <span class="c"># Script to install all components</span>
‚îú‚îÄ‚îÄ pv/ <span class="c"># Persistent volume manifests</span>
‚îÇ ‚îú‚îÄ‚îÄ kafka-pv.yaml
‚îÇ ‚îú‚îÄ‚îÄ prometheus-pv.yaml
‚îÇ ‚îî‚îÄ‚îÄ grafana-pv.yaml
‚îî‚îÄ‚îÄ values/ <span class="c"># Helm values for each component</span>
  ‚îú‚îÄ‚îÄ kafka-values.yaml
  ‚îú‚îÄ‚îÄ kafka-ui-values.yaml
  ‚îú‚îÄ‚îÄ prometheus-values.yaml
  ‚îî‚îÄ‚îÄ grafana-values.yaml
</code></pre></div></div>

<hr />

<h2 id="Ô∏è-prerequisites">üõ†Ô∏è Prerequisites</h2>

<p>Make sure you have the following installed:</p>

<ul>
  <li><a href="https://minikube.sigs.k8s.io/">Minikube</a></li>
  <li><a href="https://kubernetes.io/docs/tasks/tools/">kubectl</a></li>
  <li><a href="https://helm.sh/docs/intro/install/">Helm</a></li>
</ul>

<blockquote>
  <p>This setup assumes you‚Äôre running Kubernetes locally with Minikube.</p>
</blockquote>

<hr />

<h2 id="-installation">üöÄ Installation</h2>

<h3 id="1-start-minikube">1.‚Äì Start Minikube</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>minikube start <span class="nt">--memory</span><span class="o">=</span>4g <span class="nt">--cpus</span><span class="o">=</span>2
</code></pre></div></div>

<h3 id="2--add-helm-repositories">2.- Add Helm repositories</h3>

<ul>
  <li>This step is added in the script: Just uncomment de section</li>
</ul>

<h3 id="3--run-the-install-script">3.- Run the install script</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>monitoring
<span class="nb">chmod</span> +x deploy-all.sh
./deploy-all.sh
</code></pre></div></div>

<ul>
  <li>This script will:
    <ul>
      <li>Create a monitoring namespace.</li>
      <li>Apply persistent volumes from pv/.</li>
    </ul>
  </li>
</ul>

<h2 id="-access-to-monitoring-tools">üìã Access to Monitoring Tools</h2>

<table>
  <thead>
    <tr>
      <th>Tool</th>
      <th>External Access (NodePort)</th>
      <th>Internal Access (Cluster DNS)</th>
      <th>Important Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Grafana</strong></td>
      <td><a href="http://192.168.49.2:30095">http://192.168.49.2:30095</a></td>
      <td><code class="language-plaintext highlighter-rouge">grafana.monitoring.svc.cluster.local</code></td>
      <td>- User: <code class="language-plaintext highlighter-rouge">admin</code> <br /> - Get password:<br /> <code class="language-plaintext highlighter-rouge">kubectl get secret -n monitoring grafana -o jsonpath="{.data.admin-password}" \| base64 --decode</code></td>
    </tr>
    <tr>
      <td><strong>Kafka</strong></td>
      <td>See ports with:<br /><code class="language-plaintext highlighter-rouge">kubectl get svc -n monitoring -l "app.kubernetes.io/instance=kafka,app.kubernetes.io/component=kafka,pod" -o jsonpath='{.items[*].spec.ports[0].nodePort}'</code></td>
      <td>- Client: <code class="language-plaintext highlighter-rouge">kafka.monitoring.svc.cluster.local:9092</code><br />- Brokers: <code class="language-plaintext highlighter-rouge">kafka-controller-0/1/2.kafka-controller-headless.monitoring.svc.cluster.local:9092</code></td>
      <td>- KRaft enabled<br />- EXTERNAL listener enabled<br />- Run a client with:<br /><code class="language-plaintext highlighter-rouge">kubectl run kafka-client --rm -it --image docker.io/bitnami/kafka:4.0.0-debian-12-r8 -n monitoring -- bash</code></td>
    </tr>
    <tr>
      <td><strong>Prometheus</strong></td>
      <td>Run:<br /><code class="language-plaintext highlighter-rouge">export NODE_PORT=$(kubectl get svc -n monitoring prometheus-server -o jsonpath="{.spec.ports[0].nodePort}")</code><br /><code class="language-plaintext highlighter-rouge">export NODE_IP=$(kubectl get nodes -o jsonpath="{.items[0].status.addresses[0].address}")</code><br /><code class="language-plaintext highlighter-rouge">echo http://$NODE_IP:$NODE_PORT</code></td>
      <td><code class="language-plaintext highlighter-rouge">prometheus-server.monitoring.svc.cluster.local</code></td>
      <td>- Server and AlertManager available<br />- AlertManager: port-forward:<br /><code class="language-plaintext highlighter-rouge">kubectl port-forward -n monitoring svc/prometheus-alertmanager 9093</code><br />- PushGateway: port-forward:<br /><code class="language-plaintext highlighter-rouge">kubectl port-forward -n monitoring svc/prometheus-prometheus-pushgateway 9091</code></td>
    </tr>
  </tbody>
</table>

<p>‚úÖ Additional Notes</p>

<ul>
  <li>Minikube IP: 192.168.49.2 (verify with minikube ip if needed)</li>
  <li>Namespace: monitoring</li>
  <li>PVCs applied: grafana-pvc, kafka-pv, prometheus-pvc</li>
</ul>

<hr />

<h2 id="-verify-your-setup">üéØ Verify Your Setup</h2>

<p>Let‚Äôs make sure everything is working! You‚Äôll check that Prometheus, Grafana, Kafka, and Kafka UI are all running and accessible via NodePorts.</p>

<h2 id="-accessing-tools-from-host-minikube--docker-on-macos">üîç Accessing Tools from Host (Minikube + Docker on macOS)</h2>

<ul>
  <li>By default, services exposed via NodePort in Minikube may not be directly accessible from your host when using the Docker driver on macOS. This is due to networking limitations: the NodePort is exposed inside the Minikube VM/container, not on your host machine‚Äôs network.</li>
</ul>

<h3 id="get-the-name-of-the-tools-pods">Get the name of the tools pods</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ùØ kubectl get svc <span class="nt">-n</span> monitoring
NAME                                  TYPE        CLUSTER-IP       EXTERNAL-IP    PORT<span class="o">(</span>S<span class="o">)</span>                      AGE
grafana                               NodePort    10.102.51.68     &lt;none&gt;         80:30095/TCP                 29m
kafka                                 ClusterIP   10.100.118.216   &lt;none&gt;         9092/TCP,9095/TCP            46m
kafka-controller-0-external           NodePort    10.109.227.109   192.168.49.2   9094:30092/TCP               46m
kafka-controller-1-external           NodePort    10.97.149.130    192.168.49.2   9094:30093/TCP               46m
kafka-controller-2-external           NodePort    10.99.194.34     192.168.49.2   9094:30094/TCP               46m
kafka-controller-headless             ClusterIP   None             &lt;none&gt;         9094/TCP,9092/TCP,9093/TCP   46m
kafka-jmx-metrics                     ClusterIP   10.99.29.148     &lt;none&gt;         5556/TCP                     46m
prometheus-alertmanager               ClusterIP   10.103.180.130   &lt;none&gt;         9093/TCP                     46m
prometheus-alertmanager-headless      ClusterIP   None             &lt;none&gt;         9093/TCP                     46m
prometheus-kube-state-metrics         ClusterIP   10.102.171.116   &lt;none&gt;         8080/TCP                     46m
prometheus-prometheus-node-exporter   ClusterIP   10.97.14.115     &lt;none&gt;         9100/TCP                     46m
prometheus-prometheus-pushgateway     ClusterIP   10.101.189.12    &lt;none&gt;         9091/TCP                     46m
prometheus-server                     NodePort    10.104.67.195    &lt;none&gt;         80:30090/TCP                 46m
</code></pre></div></div>

<h3 id="example">Example</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get svc <span class="nt">-n</span> monitoring grafana

NAME      TYPE       CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>        AGE
grafana   NodePort   10.102.51.68   &lt;none&gt;        80:30095/TCP   34m


kubectl get svc <span class="nt">-n</span> monitoring prometheus-server

NAME         TYPE       CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>          AGE
prometheus   NodePort   10.98.27.101   &lt;none&gt;        9090:31090/TCP   45m


kubectl get svc <span class="nt">-n</span> monitoring kafka-ui

NAME       TYPE       CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>          AGE
kafka-ui   NodePort   10.96.220.89   &lt;none&gt;        8080:30096/TCP   19m

</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ‚ö†Ô∏è IP may change on restart (check again)</span>
minikube ip
192.168.49.2
</code></pre></div></div>

<ul>
  <li><strong><em>You might expect <code class="language-plaintext highlighter-rouge">curl &lt;http://192.168.49.2:30095&gt;</code> to work, but it doesn‚Äôt respond.</em></strong></li>
</ul>

<h3 id="-option-1-minikube-service-temporary">üß™ Option 1: minikube service (Temporary)</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Grafana</span>
minikube service grafana <span class="nt">-n</span> monitoring

<span class="c"># Prometheus</span>
minikube service prometheus-server <span class="nt">-n</span> monitoring

<span class="c"># Kafka-ui</span>
minikube service kafka-ui <span class="nt">-n</span> monitoring

</code></pre></div></div>

<ul>
  <li>This opens a temporary proxy and shows a localhost URL like:</li>
</ul>

<pre><code class="language-psql"># Grafana
|------------|---------|-------------|---------------------------|
| NAMESPACE  |  NAME   | TARGET PORT |            URL            |
|------------|---------|-------------|---------------------------|
| monitoring | grafana | service/80  | http://192.168.49.2:30095 |
|------------|---------|-------------|---------------------------|
üèÉ  Starting tunnel for service grafana.
|------------|---------|-------------|------------------------|
| NAMESPACE  |  NAME   | TARGET PORT |          URL           |
|------------|---------|-------------|------------------------|
| monitoring | grafana |             | http://127.0.0.1:56851 |
|------------|---------|-------------|------------------------|
üéâ  Opening service monitoring/grafana in default browser...
‚ùó  Because you are using a Docker driver on darwin, the terminal needs to be open to run it.


# Prometheus
|------------|-------------------|-------------|---------------------------|
| NAMESPACE  |       NAME        | TARGET PORT |            URL            |
|------------|-------------------|-------------|---------------------------|
| monitoring | prometheus-server | http/80     | http://192.168.49.2:30090 |
|------------|-------------------|-------------|---------------------------|
üèÉ  Starting tunnel for service prometheus-server.
|------------|-------------------|-------------|------------------------|
| NAMESPACE  |       NAME        | TARGET PORT |          URL           |
|------------|-------------------|-------------|------------------------|
| monitoring | prometheus-server |             | http://127.0.0.1:56409 |
|------------|-------------------|-------------|------------------------|
üéâ  Opening service monitoring/prometheus-server in default browser...
‚ùó  Because you are using a Docker driver on darwin, the terminal needs to be open to run it.


# kafka
|------------|----------|-------------|---------------------------|
| NAMESPACE  |   NAME   | TARGET PORT |            URL            |
|------------|----------|-------------|---------------------------|
| monitoring | kafka-ui | http/8080   | http://192.168.49.2:30096 |
|------------|----------|-------------|---------------------------|
üèÉ  Starting tunnel for service kafka-ui.
|------------|----------|-------------|------------------------|
| NAMESPACE  |   NAME   | TARGET PORT |          URL           |
|------------|----------|-------------|------------------------|
| monitoring | kafka-ui |             | http://127.0.0.1:64903 |
|------------|----------|-------------|------------------------|

</code></pre>

<ul>
  <li>‚úÖ Works immediately, opens browser
    <ul>
      <li>‚ùó Needs terminal to stay open (as it runs a local tunnel)</li>
      <li>‚ùó Not script-friendly or persistent</li>
    </ul>
  </li>
</ul>

<h3 id="persistent">persistent</h3>

<p>üõ† Option 2: kubectl port-forward (Persistent while running)</p>

<ul>
  <li>You can forward the Grafana service to a local port
    <ul>
      <li>With Lens, Openlens, K9s, etc</li>
      <li>Or via kubectl cmd in terminal</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl port-forward <span class="nt">-n</span> monitoring svc/grafana 30095:80

kubectl port-forward <span class="nt">-n</span> monitoring svc/prometheus 9090:9090

kubectl port-forward svc/kafka-ui 8080:8080 <span class="nt">-n</span> monitoring

</code></pre></div></div>

<ul>
  <li>
    <p><strong><em>NOTE: Yopu have to stop the temporary proxy with ctrl-c before stop minikube, and execute again on restart</em></strong></p>
  </li>
  <li>
    <p>Then visit (In this example):</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># grafana</span>
http://localhost:30095

<span class="c"># prometheus</span>
http://localhost:9090

<span class="c"># kafka</span>
http://localhost:9093

</code></pre></div></div>

<ul>
  <li><strong>Login</strong>
    <ul>
      <li><em>Grafana:</em>
        <ul>
          <li>user: admin</li>
          <li>password: admin***</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>‚úÖ Works reliably
    <ul>
      <li>‚ùó Still requires the terminal to stay open</li>
      <li>‚ùó Better suited for dev workflows, or when using tools like Lens/K9s which manage this automatically</li>
    </ul>
  </li>
</ul>

<h3 id="-option-3-minikube-tunnel-recommended-for-real-external-access">üõ° Option 3: minikube tunnel (Recommended for real external access)</h3>

<ul>
  <li>Only if you define type: as LoadBalancer instead of NodePort</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>minikube tunnel
</code></pre></div></div>

<ul>
  <li>Exposes NodePort and LoadBalancer services to your macOS host.</li>
  <li>Runs in background (but requires admin privileges).</li>
  <li>Makes the minikube ip + NodePort combination work:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl http://192.168.49.2:30095
...
</code></pre></div></div>

<ul>
  <li><strong>‚úÖ Best if you want persistent access via actual cluster IP</strong></li>
  <li><strong>‚ö†Ô∏è You‚Äôll need to keep the tunnel running in a terminal</strong></li>
</ul>

<h3 id="summary">Summary</h3>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Persistent</th>
      <th>Scriptable</th>
      <th>Requires open terminal</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">minikube service</code></td>
      <td>‚ùå</td>
      <td>‚ùå</td>
      <td>‚úÖ</td>
      <td>Great for quick UI testing</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">kubectl port-forward</code></td>
      <td>‚ùå</td>
      <td>‚úÖ</td>
      <td>‚úÖ</td>
      <td>Ideal during dev/debug</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">minikube tunnel</code></td>
      <td>‚úÖ</td>
      <td>‚úÖ</td>
      <td>‚úÖ (background)</td>
      <td>Best for stable external access</td>
    </tr>
  </tbody>
</table>

<h3 id="tools-summary">Tools Summary</h3>

<table>
  <thead>
    <tr>
      <th>Service</th>
      <th>Method</th>
      <th>Persistent</th>
      <th>Host Access</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Grafana</strong></td>
      <td><code class="language-plaintext highlighter-rouge">minikube service</code></td>
      <td>‚ùå</td>
      <td>‚úÖ</td>
      <td>UI test only</td>
    </tr>
    <tr>
      <td>¬†</td>
      <td><code class="language-plaintext highlighter-rouge">kubectl port-fwd</code></td>
      <td>‚ùå</td>
      <td>‚úÖ</td>
      <td>Dev access</td>
    </tr>
    <tr>
      <td>¬†</td>
      <td><code class="language-plaintext highlighter-rouge">minikube tunnel</code></td>
      <td>‚úÖ</td>
      <td>‚úÖ</td>
      <td>Needed for NodePort from host</td>
    </tr>
    <tr>
      <td><strong>Prometheus</strong></td>
      <td>Same as above</td>
      <td>Same</td>
      <td>Same</td>
      <td>Accessible at port 9090</td>
    </tr>
    <tr>
      <td><strong>Kafka</strong></td>
      <td><code class="language-plaintext highlighter-rouge">port-fwd 9093</code></td>
      <td>‚ùå</td>
      <td>‚úÖ (TLS)</td>
      <td>For testing with TLS listener</td>
    </tr>
    <tr>
      <td>¬†</td>
      <td><code class="language-plaintext highlighter-rouge">minikube tunnel</code></td>
      <td>‚úÖ</td>
      <td>‚úÖ</td>
      <td>Needed for TLS access from host tools</td>
    </tr>
  </tbody>
</table>

<h2 id="-stopping-and-restarting-minikube-safely">üîÑ Stopping and Restarting Minikube Safely</h2>

<p><strong><em>‚ôªÔ∏è Minikube Lifecycle (Shutdown / Restart)</em></strong></p>

<p>To safely shut down and restart your monitoring stack without losing data or encountering errors:</p>

<h3 id="-stop-minikube">‚úÖ Stop Minikube</h3>

<ul>
  <li>Use minikube stop instead of deleting the cluster:
    <ul>
      <li>This safely shuts down the VM/container.</li>
      <li>PVCs and all service configurations remain intact.</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>minikube stop
</code></pre></div></div>

<h3 id="-start-again-later">‚úÖ Start Again Later</h3>

<ul>
  <li>This restores the full state, including your deployed services, PVCs, and Helm releases.
    <ul>
      <li>All NodePorts and persistent data remain available.</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>minikube start
</code></pre></div></div>

<p><strong><em>‚ö†Ô∏è Do Not Use</em></strong></p>

<ul>
  <li>‚ùå This deletes all volumes, pods, secrets, configs ‚Äî use only if you want a clean reset.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>minikube delete
</code></pre></div></div>

<h3 id="-check-status">üß™ Check Status</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get pods <span class="nt">-n</span> monitoring
</code></pre></div></div>

<ul>
  <li>If pods don‚Äôt come up correctly (e.g., CrashLoopBackOff), you may need to:
    <ul>
      <li>Reapply deploy-all.sh</li>
      <li>
        <p>Re-check Minikube disk availability with:</p>

        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>minikube ssh
<span class="nb">df</span> <span class="nt">-h</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h3 id="-persistent-volumes--restarting-notes">üîí Persistent Volumes &amp; Restarting Notes</h3>

<table>
  <thead>
    <tr>
      <th>Component</th>
      <th>Persistent?</th>
      <th>How It‚Äôs Stored</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Prometheus</td>
      <td>‚úÖ</td>
      <td>PVC ‚Üí HostPath on VM</td>
      <td>Config &amp; scraped metrics preserved across reboots</td>
    </tr>
    <tr>
      <td>Grafana</td>
      <td>‚úÖ</td>
      <td>PVC (grafana-pvc)</td>
      <td>Dashboards, settings are saved</td>
    </tr>
    <tr>
      <td>Kafka</td>
      <td>‚úÖ</td>
      <td>PVC per broker/controller</td>
      <td>Topic data survives restart. Must wait for all brokers to rejoin.</td>
    </tr>
    <tr>
      <td>Kafka-UI</td>
      <td>‚ùå</td>
      <td>Ephemeral</td>
      <td>Will restart fresh; doesn‚Äôt affect Kafka state</td>
    </tr>
  </tbody>
</table>

<h3 id="-optional-restart-deploy-allsh-if-needed">üîÅ Optional: Restart deploy-all.sh (if needed)</h3>

<ul>
  <li>You can safely re-run the script to reapply Helm charts and PVCs:
    <ul>
      <li>üí° Helm is idempotent ‚Äî it will upgrade existing releases without data loss if PVCs exist.</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./deploy-all.sh
</code></pre></div></div>

<h3 id="-tip-back-up-persistent-data-optional">üìÅ Tip: Back Up Persistent Data (Optional)</h3>

<ul>
  <li>To snapshot your PVCs before restarting or for backup purposes:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get pvc <span class="nt">-n</span> monitoring
</code></pre></div></div>

<ul>
  <li>For example:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl <span class="nb">cp </span>monitoring/prometheus-server-0:/opt/bitnami/prometheus/data ./backup-prometheus-data
</code></pre></div></div>

<h2 id="-final-tip-automate-health-checks-optional">üß† Final Tip: Automate Health Checks (Optional)</h2>

<p>To quickly check if your monitoring stack is up and running, you can either:</p>

<h3 id="-option-a-use-the-health-check-script-recommended"><strong><em>‚úÖ Option A: Use the health check script (recommended)</em></strong></h3>

<ul>
  <li>Run the provided script to verify key components like Prometheus, Grafana, Kafka and Kafka-UI:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./check-health.sh
</code></pre></div></div>

<ul>
  <li>Response</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ùØ ./check-health.sh

‚è≥ Checking health of monitoring components <span class="k">in </span>namespace: monitoring
üîç prometheus-server...
deployment <span class="s2">"prometheus-server"</span> successfully rolled out
‚úÖ prometheus-server is healthy
üîç grafana...
deployment <span class="s2">"grafana"</span> successfully rolled out
‚úÖ grafana is healthy
üîç kafka-ui...
deployment <span class="s2">"kafka-ui"</span> successfully rolled out
‚úÖ kafka-ui is healthy
üîç kafka-controller...
statefulset rolling update <span class="nb">complete </span>3 pods at revision kafka-controller-98bc6557b...
‚úÖ kafka-controller is healthy
‚úÖ Health check completed.
</code></pre></div></div>

<ul>
  <li>If components are not found or in a bad state, the script will print warnings accordingly.</li>
  <li>You can edit the script to match the names of your deployments or statefulsets, depending on your YAMLs.</li>
</ul>

<h3 id="-option-b-check-manually-with-kubectl"><strong><em>üîç Option B: Check manually with kubectl</em></strong></h3>

<p>If you prefer manual inspection or want to verify specific resources:</p>

<ul>
  <li>List all pods in the monitoring namespace:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get pods <span class="nt">-n</span> monitoring
</code></pre></div></div>

<ul>
  <li>You should see something like:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME                                                READY   STATUS    RESTARTS        AGE
grafana-57554dd88-rc8z4                             1/1     Running   0               3h11m
kafka-controller-0                                  1/1     Running   0               175m
kafka-controller-1                                  1/1     Running   0               175m
kafka-controller-2                                  1/1     Running   0               175m
kafka-ui-5448964747-ds2bd                           1/1     Running   0               171m
prometheus-alertmanager-0                           1/1     Running   1 <span class="o">(</span>4h59m ago<span class="o">)</span>   24h
prometheus-kube-state-metrics-7f796b7d44-89mjd      1/1     Running   1 <span class="o">(</span>4h59m ago<span class="o">)</span>   24h
prometheus-prometheus-node-exporter-cltc4           1/1     Running   1 <span class="o">(</span>4h59m ago<span class="o">)</span>   24h
prometheus-prometheus-pushgateway-d4f8cb767-nwtn9   1/1     Running   1 <span class="o">(</span>4h59m ago<span class="o">)</span>   24h
prometheus-server-79798b4ff6-7g55g                  2/2     Running   2 <span class="o">(</span>4h59m ago<span class="o">)</span>   24h
...
</code></pre></div></div>

<ul>
  <li>Check services and their ports:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get svc <span class="nt">-n</span> monitoring
</code></pre></div></div>

<ul>
  <li>Look for NodePort services exposing the UIs:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME                                  TYPE        CLUSTER-IP       EXTERNAL-IP    PORT<span class="o">(</span>S<span class="o">)</span>                      AGE
grafana                               NodePort    10.104.174.27    &lt;none&gt;         80:30095/TCP                 3h11m
kafka                                 ClusterIP   10.106.201.77    &lt;none&gt;         9092/TCP,9095/TCP            175m
kafka-controller-0-external           NodePort    10.105.143.201   192.168.49.2   9094:30092/TCP               175m
kafka-controller-1-external           NodePort    10.101.82.105    192.168.49.2   9094:30093/TCP               175m
kafka-controller-2-external           NodePort    10.97.107.152    192.168.49.2   9094:30094/TCP               175m
kafka-controller-headless             ClusterIP   None             &lt;none&gt;         9094/TCP,9092/TCP,9093/TCP   175m
kafka-ui                              NodePort    10.100.56.227    &lt;none&gt;         8080:30096/TCP               171m
prometheus-alertmanager               ClusterIP   10.103.180.130   &lt;none&gt;         9093/TCP                     24h
prometheus-alertmanager-headless      ClusterIP   None             &lt;none&gt;         9093/TCP                     24h
prometheus-kube-state-metrics         ClusterIP   10.102.171.116   &lt;none&gt;         8080/TCP                     24h
prometheus-prometheus-node-exporter   ClusterIP   10.97.14.115     &lt;none&gt;         9100/TCP                     24h
prometheus-prometheus-pushgateway     ClusterIP   10.101.189.12    &lt;none&gt;         9091/TCP                     24h
prometheus-server                     NodePort    10.104.67.195    &lt;none&gt;         80:30090/TCP                 24h
</code></pre></div></div>

<ul>
  <li>Then, access the dashboards using <code class="language-plaintext highlighter-rouge">http://&lt;minikube-ip&gt;:&lt;nodeport&gt;</code>. For example:
    <ul>
      <li>Grafana: <a href="http://localhost:30095">http://localhost:30095</a></li>
      <li>Prometheus: <a href="http://localhost:30090">http://localhost:30090</a></li>
      <li>Kafka UI: <a href="http://localhost:30096">http://localhost:30096</a></li>
    </ul>
  </li>
  <li><strong>Use minikube ip to get your cluster IP if needed.</strong></li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2025-07-26T18:32:04+02:00">July 26, 2025</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?text=Local+Monitoring+Stack+for+Kubernetes%20http%3A%2F%2Flocalhost%3A4000%2Flocal-monitoring-env%2F" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Flocal-monitoring-env%2F" class="btn btn--facebook" aria-label="Share on Facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook">
    <i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/local-monitoring-env/" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>

  <a href="https://bsky.app/intent/compose?text=Local+Monitoring+Stack+for+Kubernetes%20http%3A%2F%2Flocalhost%3A4000%2Flocal-monitoring-env%2F" class="btn btn--bluesky" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Bluesky">
    <i class="fab fa-fw fa-bluesky" aria-hidden="true"></i><span> Bluesky</span>
  </a>
</section>


      
  <nav class="pagination">
    
      <a href="/local-env-sonarqube/" class="pagination--pager" title="SonarQube &amp; SonarLint for Code Analysis">Previous</a>
    
    
      <a href="/post-init/" class="pagination--pager" title="Post Init">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You May Also Enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/llp-banner.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/post-init/" rel="permalink">Post Init
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Hola üëã, este es mi primer post en Jekyll con el tema Minimal Mistakes

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/llp-banner.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/local-env-sonarqube/" rel="permalink">SonarQube &amp; SonarLint for Code Analysis
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">SonarQube &amp; SonarLint

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/llp-banner.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/local-dev-env/" rel="permalink">Building a Local Development, Testing, and Deployment Environment
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Local Development Environment Setup Guide

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/llp-banner.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/layout/python/help-tools/python-library/" rel="permalink">üêç PYTHON - Tools Library
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  
  
  


</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
          <li><a href="mailto:leobip27@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/leoncio-lopez-00527474/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/leobip" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2013 - 2025 <a href="http://localhost:4000">My Personal Page</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>









  </body>
</html>
